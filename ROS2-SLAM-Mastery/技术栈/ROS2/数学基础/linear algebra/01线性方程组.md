

## 线性方程组？

==线性方程==：
$$
a_1x_1+a_2x_2+a_3x_3+\cdots+a_nx_n = b
$$
其中的**x**不能是其他任何形式，如幂函数和指数函数或者带根号，都不行



==线性方程组==：
$$
\begin{cases}
1\times x_1 &- \quad 2\times x_2 &+ \quad 1\times x_3 &= 0\\
0 \times x_1 &+ \quad 1\times x_2 &- \quad 4\times x_3 &=4\\
0\times x_1 &+ \quad 0\times x_2 &- \quad 1\times x_3 &=3
\end{cases}
$$
为了让他们能够排版整齐===》发展为矩阵，用这种格式

1. 若有解 ： ==线性相关==
2. 若无解 ：==线性无关==

发展为==系数矩阵==:
$$
\begin{bmatrix}
1&-2&1\\
0&1&-4\\
0&0&1
\end{bmatrix}
$$
发展为==增广矩阵==：
$$
\begin{bmatrix}
1&-2&1&0\\
0&1&-4&4\\
0&0&1&3
\end{bmatrix}
$$
比系数矩阵多了一列，即方程的右边常数



### 如何求解？

#### 基本高斯消元法（顺序高斯消元法）

可以这么理解：

第一行是x1，要让第一行的第一列和第四列有值，其他为0

第二行是x2，要让第二行的第二列和第四列有值，其他为0

第三行是x3，要让第三行的第三列和第四列有值，其他为0



第四列就是代表现在这个**xn**的值。

我们将**xn**称之为**主元**，即完成高斯消元法之后的非零元素

我们将**主元**所在的列称之为**主元列**



关于高斯消元法的详细教程，位于

[线性代数及其应用》笔记01.线性方程组.ipynb](https://github.com/huangtinglin/Linear-Algebra-and-Its-Applications-notes/blob/master/%E3%80%8A%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E5%8F%8A%E5%85%B6%E5%BA%94%E7%94%A8%E3%80%8B%E7%AC%94%E8%AE%B001.%E7%BA%BF%E6%80%A7%E6%96%B9%E7%A8%8B%E7%BB%84.ipynb)

呈阶梯状分布

如下，下三角已经完成了，高斯消元法已经完成
$$
\begin{bmatrix}
1&-2&1&0\\
0&1&-4&4\\
0&0&1&3
\end{bmatrix}
$$
但是它的上三角还未完成,以下是解决方案：

**反向操作（回代简化）**：

- 从第 3 行回代，将非零值简化为对角线上的单位矩阵形式。
- **消除第 2 行第 3 列：**
  第 2 行变为：
  $$\text{Row}_2 = \text{Row}_2 - (-4) \cdot \text{Row}_3$$
  即：
  $$
  \begin{bmatrix}
  0 & 1 & 0 & 16
  \end{bmatrix}
  $$

- **消除第 1 行第 3 列：**
  第 1 行变为：
  $$\text{Row}_1 = \text{Row}_1 - \text{Row}_3$$
  即：
  $$
  \begin{bmatrix}
  1 & -2 & 0 & -3
  \end{bmatrix}
  $$

- **消除第 1 行第 2 列：**
  第 1 行变为：
  $$\text{Row}_1 = \text{Row}_1 + 2 \cdot \text{Row}_2$$
  即：
  $$
  \begin{bmatrix}
  1 & 0 & 0 & 29
  \end{bmatrix}
  $$

3. **最终的行最简矩阵**：

$$
\begin{bmatrix}
1 & 0 & 0 & -3 \\
0 & 1 & 0 & 16 \\
0 & 0 & 1 & 3
\end{bmatrix}
$$

==回带==，因为此时右下角的**主元**除了**主元列**外都为零，因而而已逐一向上回带，得出答案.

==思想==

- (倍加变换) 把某一行换成它本身与另一行的倍数的和
- (对换变换) 把两行对换
- (倍乘变换) 把某一行的所有元素乘以同一个非零数

#### 列元高斯消元法

因为在计算机中，当矩阵变大，基本高斯消元法的精度就会变的很低，浮点数运算中因**误差累积**带来的精度问题。



注意，高斯消元法都是从第一列开始消的。即格式化第一列之后才到第二列，因而我们无须关注行的前后关系。



==思想== 

- 在每一列中选择**绝对值**最大的数作为主元，然后再进行基本高斯消元法。

#### 全主元消除法

==思想==

- 在所有非零元素中选择**绝对值**最大的数作为主元，然后进行列和行的替换（如到第一行第一列），接着在基本高斯消元法

---

### **列主元与全主元对比**

| 特性         | 列主元消元法     | 全主元消元法         |
| ------------ | ---------------- | -------------------- |
| 主元选择范围 | 当前列           | 当前子矩阵           |
| 是否交换列   | 否               | 是                   |
| 数值稳定性   | 高               | 更高                 |
| 操作复杂度   | 较低             | 较高                 |
| 应用场景     | 一般数值计算场景 | 病态矩阵、高精度场景 |

#### 拓展**高斯-约当消元法**



##### **初始矩阵**
给定增广矩阵：
$$
\begin{bmatrix}
2 & 1 & -1 & 8 \\
-3 & -1 & 2 & -11 \\
-2 & 1 & 2 & -3
\end{bmatrix}
$$
每一列的目标是：让主对角线上为 `1`，并将主元所在列的其他元素化为 `0`。

---

##### **第 1 步：第 1 列的主元归一化**

1. 第 1 行的第 1 列是主元。为了让主元为 `1`，我们将 **第 1 行除以 2**：
   $$ R_1 \to \frac{R_1}{2} $$

   得到：
   $$
   \begin{bmatrix}
   1 & 0.5 & -0.5 & 4 \\
   -3 & -1 & 2 & -11 \\
   -2 & 1 & 2 & -3
   \end{bmatrix}
   $$

2. 用第 1 行消去第 2 行和第 3 行的第 1 列元素：
   - 第 2 行：$$ R_2 \to R_2 + 3 \cdot R_1 $$
   - 第 3 行：$$ R_3 \to R_3 + 2 \cdot R_1 $$

   计算后：
   $$
   \begin{bmatrix}
   1 & 0.5 & -0.5 & 4 \\
   0 & 0.5 & 0.5 & 1 \\
   0 & 2 & 1 & 5
   \end{bmatrix}
   $$

---

##### **第 2 步：第 2 列的主元归一化**

1. 第 2 行的第 2 列是主元。为了让主元为 `1`，我们将 **第 2 行除以 0.5**：
   $$ R_2 \to \frac{R_2}{0.5} $$

   得到：
   $$
   \begin{bmatrix}
   1 & 0.5 & -0.5 & 4 \\
   0 & 1 & 1 & 2 \\
   0 & 2 & 1 & 5
   \end{bmatrix}
   $$

2. 用第 2 行消去第 3 行和第 1 行的第 2 列元素：
   - 第 1 行：$$ R_1 \to R_1 - 0.5 \cdot R_2 $$
   - 第 3 行：$$ R_3 \to R_3 - 2 \cdot R_2 $$

   计算后：
   $$
   \begin{bmatrix}
   1 & 0 & -1 & 3 \\
   0 & 1 & 1 & 2 \\
   0 & 0 & -1 & 1
   \end{bmatrix}
   $$

---

##### **第 3 步：第 3 列的主元归一化**

1. 第 3 行的第 3 列是主元。为了让主元为 `1`，我们将 **第 3 行除以 -1**：
   $$ R_3 \to \frac{R_3}{-1} $$

   得到：
   $$
   \begin{bmatrix}
   1 & 0 & -1 & 3 \\
   0 & 1 & 1 & 2 \\
   0 & 0 & 1 & -1
   \end{bmatrix}
   $$

2. 用第 3 行消去第 1 行和第 2 行的第 3 列元素：
   - 第 1 行：$$ R_1 \to R_1 + R_3 $$
   - 第 2 行：$$ R_2 \to R_2 - R_3 $$

   计算后：
   $$
   \begin{bmatrix}
   1 & 0 & 0 & 2 \\
   0 & 1 & 0 & 3 \\
   0 & 0 & 1 & -1
   \end{bmatrix}
   $$

---

##### **行最简形式和解**

此时矩阵已经化为行最简形式：
$$
\begin{bmatrix}
1 & 0 & 0 & 2 \\
0 & 1 & 0 & 3 \\
0 & 0 & 1 & -1
\end{bmatrix}
$$

对应的解为：
$$
x = 2, \ y = 3, \ z = -1
$$

### **克拉默法则**

**克拉默法则**（Cramer's Rule）是一种利用行列式来解**线性方程组**的方法，适用于**系数矩阵为方阵且行列式不为零**的情况。

---

### **基本思想**

对于一个 $n \times n$ 的线性方程组：

$$
A \cdot X = B
$$

其中：

- $A$ 是系数矩阵：
  $$
  A = \begin{bmatrix}
  a_{11} & a_{12} & \cdots & a_{1n} \\
  a_{21} & a_{22} & \cdots & a_{2n} \\
  \vdots & \vdots & \ddots & \vdots \\
  a_{n1} & a_{n2} & \cdots & a_{nn}
  \end{bmatrix}
  $$

- $X$ 是未知向量：
  $$
  X = \begin{bmatrix}
  x_1 \\
  x_2 \\
  \vdots \\
  x_n
  \end{bmatrix}
  $$

- $B$ 是常数列向量：
  $$
  B = \begin{bmatrix}
  b_1 \\
  b_2 \\
  \vdots \\
  b_n
  \end{bmatrix}
  $$

**克拉默法则的核心思想**是：
- 解 $x_1, x_2, \dots, x_n$ 的值时，将系数矩阵 $A$ 的对应列替换为常数向量 $B$，然后通过行列式计算解。

公式如下：

$$
x_i = \frac{\det(A_i)}{\det(A)}, \quad i = 1, 2, \dots, n
$$

其中：
- $\det(A)$ 是系数矩阵 $A$ 的行列式。
- $\det(A_i)$ 是将 $A$ 的第 $i$ 列替换为常数向量 $B$ 后的新矩阵的行列式。

---

### **公式展开**

#### **1. 行列式公式**
标准公式：
$$
\det(A) = 
\begin{vmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & \ddots & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn}
\end{vmatrix}
$$

#### **2. 替换后的矩阵**
若求 $x_i$，将 $A$ 的第 $i$ 列替换为常数列向量 $B$：
$$
A_i = 
\begin{bmatrix}
a_{11} & a_{12} & \cdots & b_1 & \cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & b_2 & \cdots & a_{2n} \\
\vdots & \vdots & \ddots & \vdots & \ddots & \vdots \\
a_{n1} & a_{n2} & \cdots & b_n & \cdots & a_{nn}
\end{bmatrix}
$$

---

### **克拉默法则的适用条件**
1. 系数矩阵 $A$ 必须是 **方阵**（$n \times n$ 矩阵）。
2. 系数矩阵 $A$ 的行列式 $\det(A) \neq 0$，即 $A$ 是非奇异矩阵。

如果不满足这些条件，则克拉默法则不适用，线性方程组可能无解或有无穷多个解。

---

### **克拉默法则的计算过程示例**

#### **示例：二元方程组**

解以下方程组：
$$
2x + y = 5 \\
x - y = 1
$$

**步骤 1：写出系数矩阵和常数向量**
$$
A = \begin{bmatrix}
2 & 1 \\
1 & -1
\end{bmatrix}, \quad
B = \begin{bmatrix}
5 \\
1
\end{bmatrix}
$$

**步骤 2：计算 $\det(A)$**
$$
\det(A) = \begin{vmatrix}
2 & 1 \\
1 & -1
\end{vmatrix} = (2)(-1) - (1)(1) = -2 - 1 = -3
$$

**步骤 3：构造替换矩阵**
- 替换第 1 列求 $x_1$ 的矩阵：
  $$
  A_1 = \begin{bmatrix}
  5 & 1 \\
  1 & -1
  \end{bmatrix}
  $$
  行列式为：
  $$
  \det(A_1) = \begin{vmatrix}
  5 & 1 \\
  1 & -1
  \end{vmatrix} = (5)(-1) - (1)(1) = -5 - 1 = -6
  $$

- 替换第 2 列求 $x_2$ 的矩阵：
  $$
  A_2 = \begin{bmatrix}
  2 & 5 \\
  1 & 1
  \end{bmatrix}
  $$
  行列式为：
  $$
  \det(A_2) = \begin{vmatrix}
  2 & 5 \\
  1 & 1
  \end{vmatrix} = (2)(1) - (5)(1) = 2 - 5 = -3
  $$

**步骤 4：求解**
$$
x_1 = \frac{\det(A_1)}{\det(A)} = \frac{-6}{-3} = 2, \quad
x_2 = \frac{\det(A_2)}{\det(A)} = \frac{-3}{-3} = 1
$$



---

### **克拉默法则的优缺点**

#### **优点**
1. **概念直观**：克拉默法则直接利用行列式来计算变量，解的表达式明确。
2. **适合手工计算**：对于 2x2 或 3x3 的小型方程组，用克拉默法则求解较快且直观。

#### **缺点**
1. **不适合大规模矩阵**：行列式的计算复杂度较高，克拉默法则在 $n \geq 4$ 时效率低。
2. **需满足特定条件**：只有方阵且行列式非零时才能使用，无法处理病态矩阵或奇异矩阵。
3. **对数值误差敏感**：特别是在浮点数计算中，行列式的计算可能带来较大误差。

---

### **总结**

- 克拉默法则适用于 **小型线性方程组**，特别是 $n = 2$ 或 $n = 3$ 时，可以快速求解。
- 方法基于行列式计算解，逻辑简单且公式直观。
- 对于更复杂的系统（大规模矩阵或不满足条件的方程组），推荐使用高斯消元法或矩阵分解方法。